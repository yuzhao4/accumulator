from python_cpp_example import Accumulator
import numpy as np

'''
EXAMPLE
0  1  2  3  4
5  6  7  8  9
10 11 12 13 14
15 16 17 18 19
'''

# inlet cross-section velocities
row = 4
col = 5

inlet_velocities = np.zeros((row, col))

velocities_lists = []


number_cells = row * col

for i in range(number_cells):
    velocities_lists.append(list())

def get_cell_index(r, c, col_num):
    return (r * col_num + c)

def get_r_c(index, col_num):
    return[int(index/col_num), int(index%col_num)]

for cell, index in enumerate(velocities_lists):
    pass

z_cross_section_1_double_building = {'0':[57, 48, 38, 34,29,46,68,89,72,50,33,27,33,15,9],
            '1':[104,95,100,107,117,120,108,100,86,82,88,84,79,89,123,132],
            '2':[99,104,95,93,92,79,84,99,113,118,115,110,112,145,171,175,152,131,111,115],
            '3':[81,114,141,153,135,99,91,76,69,50,42,35,45,78,107,95,88,93,94,99],
            '4':[83,82,67,66,55,40,43,57,66,74,91,135,148,114,90,67,41,46,51],
            '5':[120,115,77,66,48,45,43,33,31,31,32,30,26,17,10,4,7],
            '6':[83,75,73,75,67,63,73,105,118,99,80,76,81,101,115,128,121,108,104,88,82,64],
            '7':[63,57,77,91,87,75,72,84,94,78,68,74,77,68,66,73,92,80,79,63],
            '8':[72,67,57,44,45,50,70,74,83,73,57,69,72,79,75,73,76,64,134,68,90,125],
            '9':[45,25,28,35,43,48,49,60,74,101,110,105,87,84,82,72],
            '10':[47,53,53,49,46,43,40,48,58,71,62,47,35,42,63,78,88,89,87,83],
            '11':[86,64,73,87,98,83,87,104,112,108,92,98,110,123,127,134,130,118,105,99,86,73],
            '12':[102,113,111,119,121,131,150,162,149,126,95,84,89,109,127,142,168,168,170],
            '13':[82,74,56,32,23,15,18,15,4,10,18,37,73,101,100,85,82,81,70,53,45],
            '14':[82,55,39,38,52,70,92,98,93,88,78,67,36,35,36,35,33],
            '15':[92,104,96,109,88,71,54,60,73,87,123,143,146,130,114,108,85,77,89],
            '16':[81,111,125,117,112,107,100,84,91,97,97,95,98,123,151,170,172,150,134],
            '17':[88,78,61,64,63,69,50,55,66,93,117,132,141,136,138,119,110,123,132,126,129,125,131,126,122,123,101,107,109,100,85,102,125,112],
            '18':[73,77,86,101,122,108,98,93,117,134,127,107,89,80,68,47,59,76,89,106,120,131,124,114,102],
            '19':[61,58,65,70,72,59,48,32,22,17,35,49,75,78,94,93,92,103,111,110]}

z_cross_section_2_double_building = {
    '0': [103,95,118,129,125,111,95,89,79,62,47,35,32,29,21],
    '1': [76,92,98,100,94,115,141,152,160,146,128,96,69,52,46,52],
    '2': [75,63,76,101,129,130,144,147,121,112,87,77,70,83,108],
    '3': [97,112,106,87,78,76,76,80,77,66,63,63,70,77,74],
    '4': [79,81,57,45,36,42,58,87,89,74,109,129,120,102,86,80,83,109],
    '5': [51,32,28,29,37,44,53,61,65,73,69,68,56,56,57],
    '6': [78,81,79,71,55,51,46,39,42,46,47,44,54,58,62,50],
    '7': [71,69,59,46,43,45,42,36,35,45,64,83,97,99,95,92],
    '8': [77,61,57,42,41,37,42,46,48,42,35,34,40,45,46,43,45],
    '9': [114,77,62,72,87,96,100,114,106,81,77,78,84,74,60,49],
    '10': [57,64,61,48,42,101,99,90,68,51,50,56,77,102,115,109],
    '11': [45,56,61,62,66,72,79,79,86,75,61,43,51,71,66,67],
    '12': [38,33,39,47,49,46,58,54,49,41,37,36,36,33,33,42],
    '13': [104,96,89,72,64,58,72,83,86,81,69,67,63,65,65,74,77,78],
    '14': [53,60,78,88,83,77,72,78,82,91,94,99,99,89,76],
    '15': [71,99,125,109,74,40,29,30,51,77,85,76,61,67],
    '16': [116,121,126,128,106,80,58,68,84,91,79,75,81,105,116,110,85],
    '17': [56,51,47,46,46,39,32,29,32,36,38,37,36,37,39,45],
    '18': [53,65,73,88,94,104,106,103,100,109,126,105,71,52,46,43,40,53,72,89],
    '19': [70,82,93,105,108,103,110,98,91,76,79,84,83,80]
}

z_cross_section_3_double_building = {
    '0': [100,96,103,81,71,79,100,82,84,81,84,66,53,46,57,76,95],
    '1': [107,111,121,129,127,118,91,75,57,53,54,47,41],
    '2': [84,82,62,58,64,73,77,76,65,60,59],
    '3': [80,91,118,1138,142,122,112,104,95,81,95],
    '4': [111,106,100,79,76,87,95,103,102,116,104,86,75,83,80,64],
    '5': [64,78,104,109,115,102,82,46,59,43,46,47],
    '6': [70,75,92,114,127,115,130,137,108,132,121],
    '7': [80,89,88,78,70,68,55,57,63,79,82],
    '8': [66,73,80,70,68,62,57,54,46,74,59,42],
    '9': [78,98,97,78,56,45,51,68,79,71,57,60,58,61],
    '10': [75,59,58,61,71,77,82,76,60,56,45,53,66],
    '11': [48,98,38,39,45,44,41,60,70,80,85,107],
    '12': [26,27,25,23,15,11,9,8,10],
    '13': [30,33,32,36,45,55,63,60,49,37,27],
    '14': [103,99,94,90,72,57,54,61,60,46,30,22,23],
    '15': [90,96,106,109,75,78,84,79,75,87,105,106],
    '16': [90,93,86,64,43,27,14,15,28,51,83,102,24,121],
    '17': [49,45,46,41,39,36,26,22,30,34],
    '18': [45,31,93,29,36,35,98,34,44,56],
    '19': [53,66,78,74,106,58,39,52,81,111,116,118,104,77,81]
}

z_cross_section_4_double_building = {
    '0': [45,49,51,46,37,28,25,20,29,30,47,66],
    '1': [67,70,53,51,60,55,40,35,32,37,39],
    '2': [100,101,96,83,87,111,122,121,104,96,79,66,62,53,45,61],
    '3': [104,106,96,77,81,78,66,57,48,45,60,77,84],
    '4': [47,40,40,61,71,69,50,44,45,43,48,49,29,30,37,36],
    '5': [77,76,74,47,42,49,65,79,80,72,65,58],
    '6': [38,50,61,78,82,75,66,59,63,75],
    '7': [66,75,72,76,73,91,99,90,82,70,57,42,55,77,91],
    '8': [77,71,70,73,75,69,77,84,89,88,84,72,70,82],
    '9': [69,76,84,87,69,71,81,91,92,79,63,53,66,88,98,105],
    '10': [77,79,73,58,61,59,55,50,40,30,26,26,30],
    '11': [47,69,94,113,122,101,87,76,72,68],
    '12': [34,24,15,14,16,15,13,11,16,19,18,13,16],
    '13': [90,89,77,62,44,30,31,40,47,55,58,67,73],
    '14': [64,84,98,98,81,71,84,82,75,80,72,57,50,51],
    '15': [106,81,88,98,89,84,97,123,124,108,57,56,62,71,80],
    '16': [71,61,48,67,88,73,53,55,52,63,92],
    '17': [1,5,6,7,2,6,8,9,17,22,20,16],
    '18': [49,50,46,39,42,40,38,30,23,15,9,6,16],
    '19': [37,48,63,91,128,118,82,92,81,64,41,28]
}

z_cross_section_5_double_building = {
    '0': [66,69,66,52,33,9,10,22,37,30,13,6,4],
    '1': [91,92,102,111,95,80,72,73,73,76,75,80],
    '2': [65,118,111,106,97,88,67,52,37,36,37,39],
    '3': [89,94,107,101,91,89,88,86,73,66,55,52],
    '4': [39,47,53,59,40,55,67,85,82,71],
    '5': [36,40,50,46,42,47,57,64,66,63,54,47],
    '6': [84,78,81,83,80,77,76,79,65,50,49,59],
    '7': [78,71,66,70,65,56,42,36,47,58,60,55],
    '8': [57,55,40,35,43,44,47,59,82,92,82,69],
    '9': [51,53,47,49,53,62,63,66,84,100,99,97],
    '10': [67,55,42,35,28,19,24,39,61,66,61,47,35,36],
    '11': [72,64,46,37,38,44,81,63,104,111,99,74],
    '12': [48,53,54,53,45,32,21,14,21,34,43],
    '13': [59,57,75,88,104,103,89,64,46,48,52,38],
    '14': [20,19,24,37,34,30,26,25,32,33,36,40],
    '15': [79,47,31,41,59,70,60,49,52,61,69,59],
    '16': [42,33,45,59,61,42,20,127,42,47,38,26,18],
    '17': [8,15,18,23,25,30,23,24,30,48,62,68,58],
    '18': [8,15,18,23,25,30,23,24,30,48,62,68,58],
    '19': [39,52,61,66,65,73,81,69,41,35,46,67,85]
}

z_cross_section_1_single_building = {
    '0': [74,62,53,43,38,41,44,47,46,58,92,138,180,192,166,126,87,68],
    '1': [65,57,52,46,44,64,90,94,87,84,87,83,90,90,101,98,98,82,70,53],
    '2': [109,114,131,125,129,127,136,129,129,138,142,139,142,153,167,165,148],
    '3': [116,102,70,50,36,40,57,79,93,107,116,132,132,143,149,150,121,70,90,101,92],
    '4': [173,171,166,149,137,123,98,84,128,154,116,93,91,90],
    '5': [99,72,44,33,31,39,50,55,48,56,93,128,127,102,73,62,49,46,55],
    '6': [74,60,44,43,40,44,55,58,44,28,28,37,52,75,87,83,59,44,55,48],
    '7': [94,93,86,76,82,99,124,130,126,114,115,114,130,121,113,101,119],
    '8': [166,188,164,141,106,102,112,96,98,73,68,55,57,60,56,38,55,80,113,117,133,110,116],
    '9': [117,123,109,107,61,49,40,34,32,33,58,85,111,112,114,96,77,62,60,55,45],
    '10': [73,67,61,73,105,114,115,116,123,152,157,142,131,149,146,139,104],
    '11': [124,134,124,115,111,138,142,148,109,85,94,106,141,152,155,165,163],
    '12': [76,78,63,58,76,118,126,124,115,131,145,139,122,127,130,117,119,96],
    '13': [83,92,90,91,76,63,55,56,66,89,114,104,80,58,60,72,74],
    '14': [78,69,53,40,39,38,31,21,16,17,25,37,48,55,69,84,84],
    '15': [71,70,58,41,43,54,72,80,100,116,127,125,107,84,72,81,80,96,90],
    '16': [111,113,125,137,142,121,106,90,86,105,123,144,138,145,108,127],
    '17': [152,122,145,134,113,121,131,150,141,135,124,120,123,129,115,101,83],
    '18': [88,79,76,72,65,51,85,76,115,124,135,110,90,88,91,96],
    '19': [71,64,97,96,87,67,65,73,96,96,101,116,126,128,120,104,78,50,39,36]
}

z_cross_section_1_single_building = {
    '0': [54,51,48,43,40,41,48,56,74,102,114,116,119,128,130,113],
    '1': [57,50,61,61,59,53,54,50,55,50,47,45,55,68,72,72],
    '2': [129,141,123,103,92,103,106,94,73,84,130,141,147,131,97,70],
    '3': [84,137,143,121,96,106,117,137,113,82,79,92,100,116,110],
    '4': [66,83,85,72,53,38,35,39,41,45,61,62,56],
    '5': [123,138,123,121,119,128,134,136,125,98,73,65,72,87,101,109,136,104,88,138],
    '6': [42,37,32,27,33,49,59,58,56,60,59,49,48,57,49,48],
    '7': [100,101,101,116,107,90,83,80,93,98,100,111,106,92,83],
    '8': [122,145,132,127,123,118,92,80,64,61,58,62,57,50,37],
    '9': [37,39,34,20,32,50,65,67,79,95,118,117,88,107,86,78,81,95],
    '10': [77,100,100,99,119,149,154,128,99,81,61,48,39,36,46,59,80,112,145,158,114],
    '11': [127,129,119,93,79,61,71,72,85,75,77,81,99,95,87,63,64,58,62,64],
    '12': [81,91,84,81,98,130,156,154,103,85,84,85,87,72,68],
    '13': [101,110,104,83,75,104,117,116,108,93,86,81,76,71,70,66],
    '14': [30,35,46,50,57,69,85,96,103,111,108,106,98,92,76,61,48,38,35],
    '15': [123,135,137,129,144,126,114,137,138,118,128,141,159,155,152,111,116,137,124],
    '16': [117,130,141,137,151,114,92,81,93,99,119,145,127,118,120,130],
    '17': [103,45,43,81,96,104,96,87,77,64,68,47,54,61,61,70]
    '18': [40,45,55,64,66,75,97,110,124,128,129,106,86,76,83],
    '19': [128,134,144,148,120,107,103,98,93,99,100,102,105,90]
}

z_cross_section_2_single_building = {
    '0': [52,50,47,42,84,35,40,44,54,96,52,49,41,36,110,139,40,50,64,75,145,143,101],
    '1': [131,145,138,120,112,117,127,137,146,129,109,91,82,68,41,37,36,45,63],
    '2': [60,53,58,78,91,80,84,101,96,83,63,59,62,71,83,97,103],
    '3': [75,63,79,91,121,118,105,90,87,96,103,109,122,128,119],
    '4': [45,35,39,62,82,95,83,69,59,53,60,63,77,71,68],
    '5': [105,134,139,150,136,131,120,107,103,107,112,101,75,58,46,33,26,25,24,19],
    '6': [81,83,88,82,76,89,84,79,72,85,99,119,131,139,145,148,138,130,142,144],
    '7': [54,61,52,48,42,44,42,49,48,47,42,50,51,46,35,38,40,41,36,32],
    '8': [75,93,68,52,45,36,33,32,34,44,52,57,48,46],
    '9': [50,52,68,72,94,117,126,77,115,101,98,85,92,76,62,95,70,75,80,95],
    '10': [116,123,146,157,143,105,76,61,62,72,82,100,109,106,99,107,128,140,136,137],
    '11': [52,71,86,85,100,133,137,125,121,110,112,103,90,73,67,61,68,91,114,119],
    '12': [0],
    '13': [46,44,41,43,42,40,40,39,44,49,50,47,50,45,39],
    '14': [95,91,106,125,111,119,117,148,108,90,77,163,66,61,73,92,159],
    '15': [81,84,111,121,112,109,110,116,105,94,102,96,110,118,121,118,120,109,99,106,104],
    '16': [31,36,41,42,43,40,34,30,25,24,30,36,37,36,36,36],
    '17': [0],
    '18': [46,43,35,38,34,42,44,49,44,36,40,47,52,53,52],
    '19': [143,130,116,112,131,146,155,50,19,123,90,68,27,54,40,31,25]
}

z_cross_section_3_single_building = {
    '0': [87,105,76,63,57,55,57,71,97,127,136,139,120,100,73,59,72,78,73,65,61],
    '1': [121,108,85,84,70,60,62,75,81,88,104,118,124,115,120,132,136,129,118,93,66],
    '2': [107,108,103,114,166,130,105,77,75,94,119,107,89,104,127,150,160,155,151],
    '3': [110,113,109,99,97,99,97,93,98,109,121,112,92,73,63,66,77,82],
    '4': [97,93,79,58,45,33,31,47,63,76,76,73,73,72,69,76,89,100,99,88,85],
    '5': [117,121,132,137,133,126,144,139,115,99,76,69,69,95,128,134,126,100,102,101,85],
    '6': [73,96,111,104,88,75,65,36,54,63,62,55,42,47,76,95,114,115,119,123,118],
    '7': [67,47,26,18,16,18,21,21,19,14,2,3,12,31,52,58,65,73,80,63,65,73,80,91,109,106,74,100,77],
    '8': [124,136,143,127,119,98,74,51,63,62,39,45,56,64,64,74,92,116,122,120,130],
    '9': [97,85,121,135,134,93,76,65,50,46,50,67,78,82,88,88,84,66],
    '10': [135,143,141,111,123,82,68,81,95,135,93,80,73,75,78,129,127,82,89,93,97,104],
    '11': [57,51,50,69,97,98,53,51,65,89,112,113,114,95,71,43,51,68,83,88],
    '12': [18,13,8,6,7,7,6,6,3,2,2,1,1,1,2],
    '13': [51,54,61,70,75,88,83,72,53,59,77,112,118,115,96,103,92],
    '14': [77,73,84,104,117,118,101,105,138,136,126,112,115,121,119,113],
    '15': [118,127,130,136,135,114,95,91,110,141,154,150,138,148,156,158,157,153],
    '16': [82,68,49,40,44,47,58,75,78,63,49,40,37,37,36,96,80,49,58,78,79,95,105],
    '17': [2,3,4,7,7,5,2,2,1,4,4,15,24,23,15,7,6,3],
    '18': [48,39,35,29,24,28,39,47,47,44,54,72,78,69,53,52,51,52,43,51],
    '19': [63,77,98,116,122,121,136,142,143,128,123,119,112,131,137,113,95]
}

z_cross_section_4_single_building = {
    '0': [117,112,107,88,74,68,71,81,120,94,100,84,65,106,49,43,41,40,79,41,49,72,99,115],
    '1': [115,128,126,116,123,109,102,114,131,132,129,131,138,127,108,85],
    '2': [49,52,82,98,117,125,112,111,104,105,112,118,110,99,112,124,117,95,86,80,68],
    '3': [96,109,121,117,114,100,94,78,67,73,87,104,99,100,103,115,114,97,84],
    '4': [51,46,44,47,59,74,91,93,100,98,96,84,82,96,101,98,78,67,58,60,74],
    '5': [90,75,107,78,94,84,78,83,77,76,82,91,87],
    '6': [66,83,101,115,101,87,83,87,80,74,82,86,83,67,69],
    '7': [56,58,77,83,101,92,89,93,106,113,121,119,139,141,152,69,134,110,96],
    '8': [47,54,61,71,75,105,110,105,95,99,96,88,87,75,77,71,80,74],
    '9': [46,44,48,34,28,29,34,28,27,40,53,67,71,89,92,133,140,94,92,108,112],
    '10': [71,90,96,101,109,121,114,96,77,53,29,33,48,61,68,46,41,42,50,61],
    '11': [96,91,74,65,57,51,35,33,35,50,56,60,58,57,55,72,98,106,91,67,52],
    '12': [15,11,10,12,11,16,18,32,37,40,33,27,29,32,36,32,27,28,32],
    '13': [63,56,48,46,45,40,44,55,45,38,42,48,46,43,35,34,29,23],
    '14': [78,63,45,33,22,23,47,84,105,77,64,57,50,40,34,48,65,77,71,58,63,60],
    '15': [50,70,72,63,55,40,21,18,26,43,54,39,29,27,34,44],
    '16': [33,56,81,96,100,90,77,53,39,34,42,53,68,79,82,68,48,34,28],
    '17': [52,28,20,12,10,9,8,5,2,3,11,16,22,27,34,37,28,23,20,28,40,45],
    '18': [60,39,37,48,54,61,66,50,45,50,50,41,32,30,42,51,56,47,37,31],
    '19': [42,45,50,52,54,55,61,82,92,86,61,45,30,20,17,15,14,10,20]
}

z_cross_section_5_single_building = {
    '0': [54,58,63,39,34,41,44,43,35,29,25,26,29,33,29,21,20,22],
    '1': [62,74,87,97,85,73,67,79,91,88,82,75,67,63,77,79,79,76,89,115,133,111,98,90],
    '2': [102,95,81,63,49,53,96,107,108,96,83,90,99,111,108,103,95,83,72],
    '3': [52,56,64,73,81,88,72,67,53,45,48,59,55,51,53,53,54,52,49],
    '4': [47,60,63,55,46,54,77,98,110,112,106,96,91,54,88,48,76,64,58],
    '5': [41,50,49,50,50,48,52,54,53,49,48,57,54,47,43,52],
    '6': [73,92,103,129,126,115,93,99,104,118,108,102,98,96,90,81],
    '7': [48,49,58,75,76,58,40,31,33,53,63,71,74,72,58,43,47,50,64],
    '8': [94,79,93,99,87,36,39,55,66,66,58,50,59,66,65,53,41,44,62,78,93,99,104,107,99],
    '9': [51,54,63,71,80,81,80,77,80,80,84,92,93,94,89,73,54,37],
    '10': [51,50,55,71,87,79,65,57,64,63,63,81,88,86,86,73,63,43,36,46,52,54],
    '11': [50,68,68,57,59,58,77,88,83,77,61,61,50,48,44,47,56],
    '12': [36,43,55,59,71,73,106,97,72,62,63,70,62,53,50,57,64,62,53],
    '13': [55,59,56,50,47,57,69,72,67,56,48,43,46,50,48],
    '14': [67,70,61,54,59,68,75,90,105,96,70,46,49,51,53,45,46],
    '15': [41,48,44,48,52,64,78,73,74,89,114,131,100,73,61],
    '16': [35,28,35,47,53,60,66,72,64,52,42,46,53,73,71],
    '17': [50,48,55,50,40,29,25,32,32,32,22,113,5,3,11,27,40,36,40],
    '18': [50,44,45,40,33,23,26,27,35,31,20,11,15],
    '19': [38,36,28,33,48,70,90,101,101,95,61,89,77,46] 
}

# grid of measurement points of single building
origin = [500, 505, -1000]
end_point = [-500, -245, 1000]
cell_width = [250, 250, 400]
xg_single, yg_single, zg_single = np.mgrid[origin[0]:end_point[0]:cell_width[0],
[origin[1]:end_point[1]:cell_width[1],
origin[2]:end_point:cell_width[2]]]


# initiate accumulator
my_accumulator = Accumulator(0, 0, 0, 0)

for key, index in enumerate(z_cross_section_1_single_building):
    index = int(index)

    for data in z_cross_section_1_single_building[str(key)]:
        my_accumulator.append(data)
    
    xy = get_r_c(index, col)

    mean = my_accumulator.get_mean()
    std_variance = np.sqrt(my_accumulator.get_variance())
    my_accumulator.reset()

    # here convert mean from ft/min to m/s
    inlet_velocities[xy[0], xy[1]] = mean * 0.00508

print(inlet_velocities)